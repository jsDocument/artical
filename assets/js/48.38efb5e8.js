(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{153:function(e,l,r){"use strict";r.r(l);var t=r(0),i=Object(t.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var e=this,l=e.$createElement,r=e._self._c||l;return r("div",{staticClass:"content"},[r("h3",{attrs:{id:"application模块"}},[e._v("application模块")]),r("ul",[r("li",[e._v("init 默认配置")])]),r("ol",[r("li",[e._v("挂载--请求、响应、引擎、设置")]),r("li",[e._v("views")]),r("li",[e._v("jsonp设置")]),r("li",[e._v("router")])]),r("ul",[r("li",[e._v("use")])]),r("ol",[r("li",[e._v("lazyrouter 创建路由实例、")]),r("li",[e._v("循环fns, router.use(path, fn)")]),r("li",[e._v("router.use(path, (req, res, next)=>{  })")]),r("li",[e._v("fn.emit('mount', this)")])]),r("ul",[r("li",[e._v("route")])]),r("ol",[r("li",[e._v("lazyrouter")]),r("li",[e._v("返回this._router.route(path)")])]),r("ul",[r("li",[r("p",[e._v("listen 创建服务并监听")])]),r("li",[r("p",[e._v("render")])])]),r("ol",[r("li",[e._v("获取 View")]),r("li",[e._v("根据view引擎、默认引擎、root创建View实例")]),r("li",[e._v("存入缓存")]),r("li",[e._v("view.render(...)")])]),r("ul",[r("li",[e._v("handle(req, res, callback)")])]),r("ol",[r("li",[e._v("定义done 或 finnalhandler")]),r("li",[e._v("不存在this._router, done()")]),r("li",[e._v("router.handle(req, res, done)")])]),r("ul",[r("li",[r("p",[e._v("engine this.engines[extension] = fn 设置引擎")])]),r("li",[r("p",[e._v("param")])])]),r("ol",[r("li",[e._v("lazyrouter")]),r("li",[e._v("调用router.param(name, fn)")])]),r("ul",[r("li",[e._v("set")])]),r("ol",[r("li",[e._v("etab")]),r("li",[e._v("query parser fn")]),r("li",[e._v("trust proxy fn")]),r("li",[e._v("设置其属性'@@symbol:trust_proxy_default'的特性")])]),r("p",[r("code",[e._v("setPrototypeOf")])]),r("h3",{attrs:{id:"router"}},[e._v("router")]),r("ul",[r("li",[e._v("构造函数")])]),r("ol",[r("li",[e._v("定义router函数--\x3e调用router.handle")]),r("li",[e._v("初始化实例属性")])]),r("ul",[r("li",[r("p",[e._v("param ????")])]),r("li",[r("p",[e._v("handle")])])]),r("ol",[r("li",[e._v("done")]),r("li",[e._v("next")])]),r("ul",[r("li",[e._v("use(fn)")])]),r("ol",[r("li",[e._v("callbacks 参数")]),r("li",[e._v("Layer实例, layer.route = void 0; this.stack.push(layer), 返回this")])]),r("ul",[r("li",[e._v("route(path)")])]),r("ol",[r("li",[e._v("创建Route实例 route")]),r("li",[e._v("Layer实例 layer.route = route; this.stack.push(layer); 返回route")])]),r("h3",{attrs:{id:"route"}},[e._v("Route")]),r("ul",[r("li",[r("p",[e._v("构造函数, 初始化相应实例属性")])]),r("li",[r("p",[e._v("dispatch(req, res, done)")])])]),r("ol",[r("li",[e._v("idx = 0; this.stack长度为0, 执行done()")]),r("li",[e._v("req.route = this")]),r("li",[e._v("执行next()")]),r("li",[e._v("next(err) 判断err为route, 则执行done(); err为router则执行done(err); 取出stack[idx++]相应的layer, !layer则done(err); 如果layer.method不等于 req.method则 next(err); 如果err, 则 layer.handle_err(); 否则 layer.handle_request()")])]),r("ul",[r("li",[e._v("定义http请求方法")])]),r("ol",[r("li",[e._v("this.path<---\x3e handle")]),r("li",[e._v("添加layer实例相应的method方法")]),r("li",[e._v("this.methods[method] = true, layer更新到this.stack中")])]),r("ul",[r("li",[e._v("all 与上面方法实现类似")])]),r("h3",{attrs:{id:"layer"}},[e._v("layer")]),r("ul",[r("li",[e._v("构造函数  初始化实例属性")]),r("li",[e._v("handle_err(error, req, res, next)")])]),r("ol",[r("li",[e._v("this.handle参数长度不等于4, next(error)")]),r("li",[e._v("fn(error, req, res, next)")])]),r("ul",[r("li",[e._v("handle_request(req, res, next)")])]),r("ol",[r("li",[e._v("this.handle参数大于3, next()")]),r("li",[e._v("this.handle(req, res, next)")])]),r("h2",{attrs:{id:"view"}},[e._v("View")]),r("h3",{attrs:{id:"middleware"}},[e._v("middleware")]),r("ul",[r("li",[e._v("init, (req, res, next)=>{ 返回函数, 进行属性合并与初始化, 并调用next()}")]),r("li",[e._v("query, (options)=>{ 处理参数, 返回函数query(req, res, next)=>{ req.query=... next()}}")])]),r("h3",{attrs:{id:"methods"}},[e._v("methods")]),r("ul",[r("li",[e._v("[ 'get', 'post', 'put', 'head', 'delete', 'options', 'trace', 'copy', 'lock', 'mkcol', 'move', 'purge', 'propfind', 'proppatch', 'unlock', 'report', 'mkactivity', 'checkout', 'merge', 'm-search', 'notify', 'subscribe', 'unsubscribe', 'patch', 'search', 'connect' ]")])]),r("h3",{attrs:{id:"express源码阅读收获"}},[e._v("express源码阅读收获")]),r("ol",[r("li",[e._v("路由handle--负责处理路由\n"),r("ul",[r("li",[e._v("根据req.url获取请求路径, ids=0")]),r("li",[e._v("next()方法: this.routes获取路由表{path, handle, method}[ids++]项")]),r("li",[e._v("url路径与routes中某个相同且method也相同, 则执行handle(req, res)")])])]),r("li",[e._v("路由系统")])])])}],!1,null,null,null);l.default=i.exports}}]);