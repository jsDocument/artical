<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>进入mysql命令行 | 黑盒子·技术积累</title>
    <meta name="description" content="前端知识学习轨迹">
    
    
    <link rel="preload" href="/assets/css/0.styles.6aaa91c1.css" as="style"><link rel="preload" href="/assets/js/app.53e266ef.js" as="script"><link rel="preload" href="/assets/js/97.e7f632c9.js" as="script"><link rel="prefetch" href="/assets/js/10.65134743.js"><link rel="prefetch" href="/assets/js/100.edcdb298.js"><link rel="prefetch" href="/assets/js/101.435f0869.js"><link rel="prefetch" href="/assets/js/102.21da200a.js"><link rel="prefetch" href="/assets/js/103.f65f4c72.js"><link rel="prefetch" href="/assets/js/104.dbe34b6d.js"><link rel="prefetch" href="/assets/js/105.8d5b64ff.js"><link rel="prefetch" href="/assets/js/106.5dbd0271.js"><link rel="prefetch" href="/assets/js/107.c9363391.js"><link rel="prefetch" href="/assets/js/108.836056d0.js"><link rel="prefetch" href="/assets/js/109.f0f0eb1f.js"><link rel="prefetch" href="/assets/js/11.8d57e3cd.js"><link rel="prefetch" href="/assets/js/110.0073f72a.js"><link rel="prefetch" href="/assets/js/111.9ba325f4.js"><link rel="prefetch" href="/assets/js/112.08fbd40a.js"><link rel="prefetch" href="/assets/js/113.c9da6aa7.js"><link rel="prefetch" href="/assets/js/114.15c23113.js"><link rel="prefetch" href="/assets/js/115.be405170.js"><link rel="prefetch" href="/assets/js/116.3e29fb4f.js"><link rel="prefetch" href="/assets/js/117.0003be20.js"><link rel="prefetch" href="/assets/js/118.01454b1f.js"><link rel="prefetch" href="/assets/js/119.4f813a92.js"><link rel="prefetch" href="/assets/js/12.ebce4ebd.js"><link rel="prefetch" href="/assets/js/120.b0b2e874.js"><link rel="prefetch" href="/assets/js/121.7bcd6cb7.js"><link rel="prefetch" href="/assets/js/122.68e73afa.js"><link rel="prefetch" href="/assets/js/123.d8e5ef43.js"><link rel="prefetch" href="/assets/js/124.3e3f5c26.js"><link rel="prefetch" href="/assets/js/125.1a020a12.js"><link rel="prefetch" href="/assets/js/126.d582114c.js"><link rel="prefetch" href="/assets/js/127.7b1f520f.js"><link rel="prefetch" href="/assets/js/128.4a5e3787.js"><link rel="prefetch" href="/assets/js/129.357354f5.js"><link rel="prefetch" href="/assets/js/13.b45d341e.js"><link rel="prefetch" href="/assets/js/130.32686c00.js"><link rel="prefetch" href="/assets/js/131.b0a57325.js"><link rel="prefetch" href="/assets/js/132.089f2cf8.js"><link rel="prefetch" href="/assets/js/133.f398bcef.js"><link rel="prefetch" href="/assets/js/134.7cd23d13.js"><link rel="prefetch" href="/assets/js/135.9d6b3bb3.js"><link rel="prefetch" href="/assets/js/136.634f39f2.js"><link rel="prefetch" href="/assets/js/137.4225c9ed.js"><link rel="prefetch" href="/assets/js/138.3524e04a.js"><link rel="prefetch" href="/assets/js/139.090f709d.js"><link rel="prefetch" href="/assets/js/14.c9723882.js"><link rel="prefetch" href="/assets/js/140.cc559854.js"><link rel="prefetch" href="/assets/js/141.6a3098a2.js"><link rel="prefetch" href="/assets/js/142.e5d240b9.js"><link rel="prefetch" href="/assets/js/143.4122507f.js"><link rel="prefetch" href="/assets/js/144.8a8842a5.js"><link rel="prefetch" href="/assets/js/145.55c6956b.js"><link rel="prefetch" href="/assets/js/146.258ed128.js"><link rel="prefetch" href="/assets/js/147.b97aad1d.js"><link rel="prefetch" href="/assets/js/148.92928163.js"><link rel="prefetch" href="/assets/js/149.90a05f04.js"><link rel="prefetch" href="/assets/js/15.5c8969d9.js"><link rel="prefetch" href="/assets/js/150.4656c394.js"><link rel="prefetch" href="/assets/js/151.32ef9274.js"><link rel="prefetch" href="/assets/js/152.a007161e.js"><link rel="prefetch" href="/assets/js/153.6a0aabb3.js"><link rel="prefetch" href="/assets/js/154.f3cc11d0.js"><link rel="prefetch" href="/assets/js/155.1f0f0049.js"><link rel="prefetch" href="/assets/js/156.022881cd.js"><link rel="prefetch" href="/assets/js/157.1dfc75fd.js"><link rel="prefetch" href="/assets/js/158.8c0ce2d0.js"><link rel="prefetch" href="/assets/js/159.d65e6462.js"><link rel="prefetch" href="/assets/js/16.99a00e7e.js"><link rel="prefetch" href="/assets/js/160.7a8fab95.js"><link rel="prefetch" href="/assets/js/161.cf36e107.js"><link rel="prefetch" href="/assets/js/162.05ef6079.js"><link rel="prefetch" href="/assets/js/163.01087eb6.js"><link rel="prefetch" href="/assets/js/164.4cb8666c.js"><link rel="prefetch" href="/assets/js/165.08a9fd5c.js"><link rel="prefetch" href="/assets/js/166.af8016d5.js"><link rel="prefetch" href="/assets/js/167.94fc4700.js"><link rel="prefetch" href="/assets/js/168.6ab9b48f.js"><link rel="prefetch" href="/assets/js/169.97bd04ac.js"><link rel="prefetch" href="/assets/js/17.df2a4eb4.js"><link rel="prefetch" href="/assets/js/170.f8c6be84.js"><link rel="prefetch" href="/assets/js/171.641c932f.js"><link rel="prefetch" href="/assets/js/172.bf3db2f4.js"><link rel="prefetch" href="/assets/js/173.ae10cce5.js"><link rel="prefetch" href="/assets/js/174.f4bf5aaa.js"><link rel="prefetch" href="/assets/js/175.4ab1b991.js"><link rel="prefetch" href="/assets/js/176.9f2a4d72.js"><link rel="prefetch" href="/assets/js/177.81341ab0.js"><link rel="prefetch" href="/assets/js/178.8fba3329.js"><link rel="prefetch" href="/assets/js/179.949fdcc3.js"><link rel="prefetch" href="/assets/js/18.78753ebb.js"><link rel="prefetch" href="/assets/js/180.7fdb370a.js"><link rel="prefetch" href="/assets/js/181.68936906.js"><link rel="prefetch" href="/assets/js/182.6af71721.js"><link rel="prefetch" href="/assets/js/183.4535edda.js"><link rel="prefetch" href="/assets/js/184.165558bc.js"><link rel="prefetch" href="/assets/js/185.56598814.js"><link rel="prefetch" href="/assets/js/186.2ffb9d14.js"><link rel="prefetch" href="/assets/js/187.b6f015cc.js"><link rel="prefetch" href="/assets/js/188.c10d4322.js"><link rel="prefetch" href="/assets/js/189.1d556cd4.js"><link rel="prefetch" href="/assets/js/19.8f00b3f8.js"><link rel="prefetch" href="/assets/js/190.525bc3a7.js"><link rel="prefetch" href="/assets/js/191.83bc9e54.js"><link rel="prefetch" href="/assets/js/192.fa2d48ff.js"><link rel="prefetch" href="/assets/js/193.27effd38.js"><link rel="prefetch" href="/assets/js/194.d849610b.js"><link rel="prefetch" href="/assets/js/195.3a7313a0.js"><link rel="prefetch" href="/assets/js/196.96f12b40.js"><link rel="prefetch" href="/assets/js/197.354a6d50.js"><link rel="prefetch" href="/assets/js/198.9ef5d4c5.js"><link rel="prefetch" href="/assets/js/199.4327cf34.js"><link rel="prefetch" href="/assets/js/2.6d2e3f4b.js"><link rel="prefetch" href="/assets/js/20.5d31049a.js"><link rel="prefetch" href="/assets/js/200.533a4abd.js"><link rel="prefetch" href="/assets/js/201.9e8d3530.js"><link rel="prefetch" href="/assets/js/202.376739a1.js"><link rel="prefetch" href="/assets/js/203.5985aa2b.js"><link rel="prefetch" href="/assets/js/204.42b86cfb.js"><link rel="prefetch" href="/assets/js/205.a2fd3ed6.js"><link rel="prefetch" href="/assets/js/206.f948b1f4.js"><link rel="prefetch" href="/assets/js/207.17b7eefe.js"><link rel="prefetch" href="/assets/js/208.56aedf3c.js"><link rel="prefetch" href="/assets/js/209.078f1d9a.js"><link rel="prefetch" href="/assets/js/21.0e9105df.js"><link rel="prefetch" href="/assets/js/210.b6932ce8.js"><link rel="prefetch" href="/assets/js/211.4954982f.js"><link rel="prefetch" href="/assets/js/212.1907420f.js"><link rel="prefetch" href="/assets/js/213.d9c88070.js"><link rel="prefetch" href="/assets/js/214.a5dd1ea7.js"><link rel="prefetch" href="/assets/js/215.d924acad.js"><link rel="prefetch" href="/assets/js/216.05d3016c.js"><link rel="prefetch" href="/assets/js/217.313972da.js"><link rel="prefetch" href="/assets/js/218.9796a542.js"><link rel="prefetch" href="/assets/js/22.40c83017.js"><link rel="prefetch" href="/assets/js/23.50e6d6ff.js"><link rel="prefetch" href="/assets/js/24.4a2f91c4.js"><link rel="prefetch" href="/assets/js/25.bcd3d997.js"><link rel="prefetch" href="/assets/js/26.1d09d398.js"><link rel="prefetch" href="/assets/js/27.c13cdd01.js"><link rel="prefetch" href="/assets/js/28.d155f933.js"><link rel="prefetch" href="/assets/js/29.c1ea88cd.js"><link rel="prefetch" href="/assets/js/3.8b3d3652.js"><link rel="prefetch" href="/assets/js/30.0e0939c8.js"><link rel="prefetch" href="/assets/js/31.d096d0b3.js"><link rel="prefetch" href="/assets/js/32.a9fd67b8.js"><link rel="prefetch" href="/assets/js/33.b8ab3f91.js"><link rel="prefetch" href="/assets/js/34.e2226023.js"><link rel="prefetch" href="/assets/js/35.5081c2d5.js"><link rel="prefetch" href="/assets/js/36.34ae22dc.js"><link rel="prefetch" href="/assets/js/37.1b8715dd.js"><link rel="prefetch" href="/assets/js/38.3110c263.js"><link rel="prefetch" href="/assets/js/39.972c3894.js"><link rel="prefetch" href="/assets/js/4.c972694d.js"><link rel="prefetch" href="/assets/js/40.eb8db093.js"><link rel="prefetch" href="/assets/js/41.4f62fb28.js"><link rel="prefetch" href="/assets/js/42.247caac1.js"><link rel="prefetch" href="/assets/js/43.45835af8.js"><link rel="prefetch" href="/assets/js/44.70093046.js"><link rel="prefetch" href="/assets/js/45.076ef641.js"><link rel="prefetch" href="/assets/js/46.b0c97590.js"><link rel="prefetch" href="/assets/js/47.188cfc7a.js"><link rel="prefetch" href="/assets/js/48.855eee86.js"><link rel="prefetch" href="/assets/js/49.4a3ab375.js"><link rel="prefetch" href="/assets/js/5.011b3f89.js"><link rel="prefetch" href="/assets/js/50.aeccab23.js"><link rel="prefetch" href="/assets/js/51.b532c2aa.js"><link rel="prefetch" href="/assets/js/52.87aec73a.js"><link rel="prefetch" href="/assets/js/53.d6c97914.js"><link rel="prefetch" href="/assets/js/54.3c552e7c.js"><link rel="prefetch" href="/assets/js/55.c0c062fb.js"><link rel="prefetch" href="/assets/js/56.e2411e6d.js"><link rel="prefetch" href="/assets/js/57.cb1271d4.js"><link rel="prefetch" href="/assets/js/58.4228e209.js"><link rel="prefetch" href="/assets/js/59.48c04d2f.js"><link rel="prefetch" href="/assets/js/6.34ddb53a.js"><link rel="prefetch" href="/assets/js/60.d3356cd7.js"><link rel="prefetch" href="/assets/js/61.e4cd6c35.js"><link rel="prefetch" href="/assets/js/62.71276191.js"><link rel="prefetch" href="/assets/js/63.556c61c9.js"><link rel="prefetch" href="/assets/js/64.cedca265.js"><link rel="prefetch" href="/assets/js/65.023654c8.js"><link rel="prefetch" href="/assets/js/66.7e80b052.js"><link rel="prefetch" href="/assets/js/67.20afac95.js"><link rel="prefetch" href="/assets/js/68.6b692212.js"><link rel="prefetch" href="/assets/js/69.4d1e497f.js"><link rel="prefetch" href="/assets/js/7.b4eff34b.js"><link rel="prefetch" href="/assets/js/70.d6c6121d.js"><link rel="prefetch" href="/assets/js/71.ebc935fd.js"><link rel="prefetch" href="/assets/js/72.86027ec8.js"><link rel="prefetch" href="/assets/js/73.33c5d698.js"><link rel="prefetch" href="/assets/js/74.e38e2caf.js"><link rel="prefetch" href="/assets/js/75.56e7a7db.js"><link rel="prefetch" href="/assets/js/76.93145b2b.js"><link rel="prefetch" href="/assets/js/77.ad3a1c9f.js"><link rel="prefetch" href="/assets/js/78.97841262.js"><link rel="prefetch" href="/assets/js/79.801ccbf7.js"><link rel="prefetch" href="/assets/js/8.b2d477ee.js"><link rel="prefetch" href="/assets/js/80.4bd08d47.js"><link rel="prefetch" href="/assets/js/81.c9f61be9.js"><link rel="prefetch" href="/assets/js/82.00c14b0e.js"><link rel="prefetch" href="/assets/js/83.2a84d9ba.js"><link rel="prefetch" href="/assets/js/84.adc0a12b.js"><link rel="prefetch" href="/assets/js/85.630c01a9.js"><link rel="prefetch" href="/assets/js/86.695e1509.js"><link rel="prefetch" href="/assets/js/87.994bb24d.js"><link rel="prefetch" href="/assets/js/88.5c981760.js"><link rel="prefetch" href="/assets/js/89.94e8006b.js"><link rel="prefetch" href="/assets/js/9.cc3a5010.js"><link rel="prefetch" href="/assets/js/90.8ab05109.js"><link rel="prefetch" href="/assets/js/91.76b937bc.js"><link rel="prefetch" href="/assets/js/92.ebdb482b.js"><link rel="prefetch" href="/assets/js/93.1078aa16.js"><link rel="prefetch" href="/assets/js/94.84a7d829.js"><link rel="prefetch" href="/assets/js/95.bd238429.js"><link rel="prefetch" href="/assets/js/96.f5c5e898.js"><link rel="prefetch" href="/assets/js/98.d550a398.js"><link rel="prefetch" href="/assets/js/99.9d12b71c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.6aaa91c1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">黑盒子·技术积累</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">jvascript 系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/base/" class="nav-link">jvascript 基础系列</a></li><li class="dropdown-item"><!----> <a href="/basic/promise/" class="nav-link">javascript 高阶专题系列</a></li><li class="dropdown-item"><!----> <a href="/basic/http/" class="nav-link">http 系列知识</a></li></ul></div></div><div class="nav-item"><a href="/LeetCode/" class="nav-link">leetCode系列</a></div><div class="nav-item"><a href="/tools/" class="nav-link">工具系列</a></div><div class="nav-item"><a href="/vue-resource/" class="nav-link">vue 系列</a></div><div class="nav-item"><a href="/react/" class="nav-link">react 系列</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">jvascript 系列</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/basic/base/" class="nav-link">jvascript 基础系列</a></li><li class="dropdown-item"><!----> <a href="/basic/promise/" class="nav-link">javascript 高阶专题系列</a></li><li class="dropdown-item"><!----> <a href="/basic/http/" class="nav-link">http 系列知识</a></li></ul></div></div><div class="nav-item"><a href="/LeetCode/" class="nav-link">leetCode系列</a></div><div class="nav-item"><a href="/tools/" class="nav-link">工具系列</a></div><div class="nav-item"><a href="/vue-resource/" class="nav-link">vue 系列</a></div><div class="nav-item"><a href="/react/" class="nav-link">react 系列</a></div> <!----></nav>  <!----> </div> <div class="page"> <div class="content"><h2 id="进入mysql命令行"><a href="#进入mysql命令行" class="header-anchor">#</a> 进入mysql命令行</h2> <ol><li>brew services start mysql</li> <li>mysql -u root</li> <li>远程：mysql -h host -p port -u root -p pwd</li> <li>mysql --skip-grant-tables 跳过权限验证</li></ol> <h2 id="常用查询"><a href="#常用查询" class="header-anchor">#</a> 常用查询</h2> <p>show processlist 正在运行的线程
show variables
select database() 当前数据库
select now(), user(), version() 当前时间、用户、版本</p> <p>怎么样保存上一句查找结果？</p> <h2 id="用户变量-作用域为整个会话-或-在过程中为局部变量赋值"><a href="#用户变量-作用域为整个会话-或-在过程中为局部变量赋值" class="header-anchor">#</a> 用户变量----作用域为整个会话 或 在过程中为局部变量赋值</h2> <p>set @varName = expr, ...    不加前缀，默认为会话变量
select @varName:=(select) 或 set @varName=(select)</p> <p>show session variables 显示会话变量
show global variables 显示全局变量</p> <p>set session varName=value 或 set @@session.varName=value</p> <p>select @@session/global.varName 查询值</p> <p>: @@session 或以用 @@local代替</p> <h2 id="存储过程变量-会默认初始化为null"><a href="#存储过程变量-会默认初始化为null" class="header-anchor">#</a> 存储过程变量----会默认初始化为null</h2> <p>declare varName type default 0</p> <h2 id="拾贝"><a href="#拾贝" class="header-anchor">#</a> 拾贝</h2> <ol><li>do sleep(5)</li></ol> <h2 id="select-all-distinct-select表达式-from-where-group-by-having-order-by-limit"><a href="#select-all-distinct-select表达式-from-where-group-by-having-order-by-limit" class="header-anchor">#</a> select [all | distinct] select表达式 from, where, group by, having, order by, limit</h2> <h2 id="select-表达式"><a href="#select-表达式" class="header-anchor">#</a> select 表达式</h2> <ol><li><ul><li></li></ul></li> <li>计算公式、函数调用、表达式，聚合函数：count, sum, avg, max, min（在select 的返回字段中）</li> <li>field 或用 as 使用别名</li> <li>ifnull(exp1, exp2), if(expr, exp1, exp2), coalesce()</li></ol> <h2 id="where-语句可用的关键表达式-与-函数-子句-，字段必须是数据表存在的，不可以是别名，不可以聚合函数"><a href="#where-语句可用的关键表达式-与-函数-子句-，字段必须是数据表存在的，不可以是别名，不可以聚合函数" class="header-anchor">#</a> where 语句可用的关键表达式 与 函数(子句)，字段必须是数据表存在的，不可以是别名，不可以聚合函数</h2> <ol><li>in / not in()</li> <li>(not) like &quot;%_&quot;</li> <li>is null</li> <li>is not true / false / unknown</li> <li>(not) between and</li> <li>and, or, xor</li> <li>=, +&lt;=&gt;, +&lt;&gt;, !=, +&lt;=, +&lt;, &gt;=, &gt;, !, &amp;&amp;, ||</li> <li>可以用子句，子句返回聚合的数据，然后再筛选</li></ol> <h2 id="having子句，结果再次筛选，字段必须是筛选出来的，可以是别名"><a href="#having子句，结果再次筛选，字段必须是筛选出来的，可以是别名" class="header-anchor">#</a> having子句，结果再次筛选，字段必须是筛选出来的，可以是别名</h2> <h2 id="与case语句一起"><a href="#与case语句一起" class="header-anchor">#</a> 与case语句一起</h2> <p>select case v when expr then exp1 else exp2 end;</p> <h2 id="补充限定"><a href="#补充限定" class="header-anchor">#</a> 补充限定</h2> <ol><li>order by field desc / asc</li></ol> <h2 id="类型"><a href="#类型" class="header-anchor">#</a> 类型</h2> <ol><li><p>整形
tinyint
smallint
mediumint
int(M)
bigint</p></li> <li><p>浮点型
float(M, D)
double(M, D)</p></li> <li><p>定点数
decimal(总位数，小数点位数)</p></li> <li><p>字符串
char
varchar</p></li></ol> <ul><li><p>二进制
blob
text</p></li> <li><p>binary, varbinary</p></li></ul> <ol start="5"><li>日期</li></ol> <ul><li>datetime  “YYYY-MM-DD hh:mm:ss”</li> <li>date   “YYYY-MM-DD”</li> <li>times  tamp  “YY-MM-DD hh:mm:ss”</li> <li>time    “hh:mm:ss”</li> <li>year   “YYYY”</li></ul> <ol start="6"><li>枚举</li></ol> <ul><li>enum()</li> <li>set()</li></ul> <h2 id="定义-create-alter-drop"><a href="#定义-create-alter-drop" class="header-anchor">#</a> 定义 create, alter, drop</h2> <ul><li>数据库</li></ul> <ol><li>创建 create {database | schema} [if not exists] db_name default character set =</li> <li>选择 use db_name</li> <li>修改 alter {database | schema} [db_name] default charracter set gb2312 default collate ... 字符集和校对规则</li> <li>删除 drop  {database | schema} [if exists] db_name</li> <li>查看 show {databases | schemas} [like 'pattern' | where expr]</li></ol> <ul><li>表</li></ul> <ol><li>create [temporary] table tbl_name(
field type [列级完整性约束] [default value]----int double bool (long) date timestamp time char varchar NULL; float
[表级完整性约束]:
primary key(field, field...)
[unique] index idx_name(feild...)
foreign key(field)
reference other_tbl_name(field)
on delete restrict
on update restrict
)[engine=]</li> <li>修改 alter table tbl_name 【add column | change column | alter column | modify column | drop column | rename To db.tbl_name】.... change可以修改表名、类型、约束；alter修改默认值；modify 修改类型
First, after field 定义列的位置
添加索引 add [unique | primary | foreign] index|key idx_name(idx_col_name,...)
删除索引 drop primary key
drop index idx_name
drop foreign key</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> forTest<span class="token punctuation">.</span>S_C <span class="token keyword">add</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span><span class="token punctuation">(</span>Cno<span class="token punctuation">)</span> <span class="token keyword">references</span> forTest<span class="token punctuation">.</span>C<span class="token punctuation">(</span>Cno<span class="token punctuation">)</span> <span class="token keyword">on</span> <span class="token keyword">delete</span> <span class="token keyword">cascade</span> <span class="token keyword">on</span> <span class="token keyword">update</span> <span class="token keyword">cascade</span><span class="token punctuation">;</span>
<span class="token keyword">alter</span> <span class="token keyword">table</span> forTest<span class="token punctuation">.</span>S change <span class="token keyword">column</span> Sname <span class="token keyword">char</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="3"><li>重命名 rename table tbl_name TO new_tbl_name</li> <li>删除 drop table ... [restrict | cascade]</li> <li>查看表 show [full] tables [from | in] tbl_name</li> <li>查看表结构 show [full] columns [from | in] tbl_name [like 'pattern' | where expr] 或 desc db.tbl_name</li> <li>show table status from databases 数据库管理系统性能及统计信息</li></ol> <ul><li>列</li></ul> <ol><li>show columns from tabName</li></ol> <ul><li>索引 index, unique, primary key</li></ul> <ol><li>create [unique] index idx_name on tbl_name (idx_col_name(length) asc/desc,...) 索引在表中的名称是唯一的，索引列的描述</li> <li>查看 show {index | indexes | keys} {from | in} tbl_name {from | in} db_name [where expr]</li> <li>删除 drop index idx_name ON tbl_name</li></ol> <h2 id="操纵-select-insert-update-delete"><a href="#操纵-select-insert-update-delete" class="header-anchor">#</a> 操纵 select, insert, update, delete</h2> <ul><li>插入</li></ul> <ol><li>insert into tbl_name [(col_name,...)省略为全部] {values | value} ({expr | default},...) (...);</li> <li>insert into tbl_name SET col_name={exprr | DEFAULT}, ...</li> <li>insert into tbl_name [(col_name,...)] SELECT 将查询数据插入到另一个表中</li></ol> <ul><li>删除</li></ul> <ol><li>delete from tbl_name [where condition] [order by ...] [limit n] 删除一行或多行数据</li></ol> <ul><li>更新</li></ul> <ol><li>update tbl_name SET col_name={expr | DEFAULT}, ... [where condition] [order by ...] [limit n]</li></ol> <ul><li>查询</li></ul> <ol><li><p>select [all|distinct去除重复行] field/select_expr,... 如：*, field as new_name
from tbl_references
where
group by
having
order by
limit</p></li> <li><p>select_expr: 可以是聚合函数 count, max, min, sum, avg, std标准值, variance方差, group_concat 一组列值组合而成的结果, bit_and, bit_or, bit_xor 异或</p></li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code>
<span class="token keyword">select</span> field <span class="token operator">+</span> v

<span class="token keyword">select</span> field
<span class="token keyword">case</span>
<span class="token keyword">when</span> condition <span class="token keyword">then</span> <span class="token string">'value'</span>
<span class="token keyword">else</span> <span class="token string">'value2'</span>
<span class="token keyword">end</span> <span class="token punctuation">[</span><span class="token keyword">as</span><span class="token punctuation">]</span> new_name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ol start="3"><li>from 多表连接查询</li></ol> <ul><li>交叉----tbl cross join tbl2 或逗号分隔 结果是乘积；</li> <li>内连接----tbl {inner join | join} tbl2 ON condition 消除交叉连接中的某些行，自连接：查找相同列值的行时用（表与自身连接）</li> <li>外连接----基表和参考表，以基表为依据返回满足和不满足条件的记录，{left outer join | left join} 与关键字的右边表进行匹配, null表示右表没有找到与左表相符的记录；{right outer join | right join} 右表为基表 on condition</li></ul> <ol start="4"><li>where</li></ol> <ul><li>比较运算 +&lt;&gt;, !=, +&lt;=&gt;</li> <li>范围 expr [not] between expr1 and expr2； expr IN (list)</li> <li>空值 expr IS [NOT] NULL</li> <li>子查询 expr [not] IN (select...)；expr 比较运算 {ALL | SOME | ANY} (select...)；exist (select...)</li></ul> <ol start="5"><li>group by 根据选择的列的值进行逻辑分组 {col_name <code>select列中的项</code>|expr<code>通常与聚合函数一起使用</code>|position<code>select 结果集中的位置</code>} [asc|desc], ... [WITH ROLLUP<code>汇总行</code>] 条件不可以是聚合函数</li> <li>having 对分组再进行过滤，可以是聚合函数</li> <li>order by {col_name | expr | position <code>select结果集中的位置</code>} [asc|desc], ... 升序、降序，空值最小</li> <li>limit {[offset,] row_count | row_count OFFSET offset}</li></ol> <ul><li>数据安全性与一致性</li></ul> <ol><li>实例完整性约束-----主键，如果是一个字段，则可以定义为列或表完整性约束，如果是多个字段，必须为表完整性约束；一个表一个。</li> <li>实例完整性约束-----候选键，唯一且不为NULL，unique 键，unique索引。</li> <li>参照完整性约束-----列上添加references，表上添加foreign key(col_name, ...<code>被参照表中的主键或候选键</code>) references</li> <li>restrict 拒绝对被参照表的删除和更新操作；cascade 被参照表更新，则更新参照表中匹配的记录；set NULL  被参照表更新，则更新参照表对应外键为NULL, no action 同restrict。</li> <li>触发器----完善主键与外键不能保证的复杂的参照完整性</li> <li>用户自定义完整性----NOT NULL 或 check(expr)</li> <li>命名完整性约束----- constraint [symbol]</li></ol> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">alter</span> <span class="token keyword">table</span> tbl_name <span class="token keyword">add</span> <span class="token keyword">foreign</span> <span class="token keyword">key</span> <span class="token punctuation">(</span>col_name<span class="token punctuation">)</span>
<span class="token keyword">references</span> other_tbl_name <span class="token punctuation">(</span>idx_col_name<span class="token punctuation">(</span>length<span class="token punctuation">)</span> <span class="token keyword">asc</span><span class="token operator">/</span><span class="token keyword">desc</span><span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
  <span class="token keyword">on</span> <span class="token keyword">delete</span> {<span class="token keyword">restrict</span> <span class="token operator">|</span> <span class="token keyword">cascade</span> <span class="token operator">|</span> <span class="token keyword">set</span> <span class="token boolean">NULL</span> <span class="token operator">|</span> <span class="token keyword">no</span> <span class="token keyword">action</span>}


<span class="token keyword">create</span> <span class="token keyword">trigger</span> t_name t_time t_event <span class="token keyword">ON</span> tbl_name <span class="token keyword">for each row</span> t_body
t_time<span class="token comment">---before/after</span>
t<span class="token operator">-</span>event<span class="token comment">---insert/update/delete</span>
t_body<span class="token comment">----多行用begin...end；单行SET @var=&quot;value&quot;</span>
<span class="token keyword">insert</span><span class="token comment">----NEW.field来访问被插入的数据</span>
<span class="token keyword">delete</span><span class="token comment">----OLD.field访问之间的值</span>
<span class="token keyword">update</span><span class="token comment">----可以访问NEW及OLD</span>


<span class="token keyword">drop</span> <span class="token keyword">trigger</span> <span class="token punctuation">[</span><span class="token keyword">if</span> <span class="token keyword">exists</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>schema_name<span class="token punctuation">.</span><span class="token punctuation">]</span>t_name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>视图</li></ul> <ol><li>创建 create view v_name [(col_list)] AS select_statement [with [cascaed|local <code>检查所有或当前视图</code>] check option <code>修改时需要符合select</code>]</li> <li>drop view [if exists] v_name,...[restrict | cascade]</li> <li>alter view v_name [(col_list)] AS select_s ...</li> <li>show create view v_name</li> <li>insert into v_name values (...)</li> <li>update v_name set field=''</li> <li>delete from v_name where ...</li></ol> <h2 id="控制-grant-revoke"><a href="#控制-grant-revoke" class="header-anchor">#</a> 控制 grant, revoke</h2> <ul><li>账户</li></ul> <ol><li>create user u_name[identified by [PASSWORD] 'password']------要有insert、全局create user权限，需要在mysql的user表中插入一条数据，新用户只有show权限。</li> <li>select PASSWORD(456) 查询其对应的散列值</li> <li>drop user u_name@host----要有delete、全局create user权限</li> <li>rename user old_u_name To new_user,[...]----要有update、全局create user权限</li> <li>修改口令----set password [FOR user@host]={PASSWORD('new_pwd') | 'pwd'<code>已加密的口令</code>}</li></ol> <ul><li>权限</li></ul> <ol><li><p>查看show grants for 'u_name'</p></li> <li><p>授权：grant {select|upate|delete|create user...[(col_list)],...}  ON {db_name|tbl_name} [level 列、表、库、用户权限] TO u_name [identified BY [PASSWORD] 'pwd'][with grant option <code>把自己所有权限授于其他用户</code>]</p></li> <li><p>当前库所有表：<em>，所有库的所有表：</em>.*，db_name.*库中所有表，db_name.tbl_name/v_name，db_name.func_name</p></li> <li><p>revoke {select|upate|delete|create user...[(col_list)],...}  ON {db_name|tbl_name} from 'user@host'</p></li> <li><p>刷新权限 flush privileges</p></li> <li><p>所有权限：</p></li> <li><p>Alter 　　修改表和索引</p></li> <li><p>Create 　创建数据库和表</p></li> <li><p>Delete 　删除表中已有的记录</p></li> <li><p>Drop 　　 抛弃（删除）数据库和表</p></li> <li><p>INDEX 　创建或抛弃索引</p></li> <li><p>Insert 　 向表中插入新行</p></li> <li><p>REFERENCE 　　未用</p></li> <li><p>Select　　　　 检索表中的记录</p></li> <li><p>Update 　　　　 修改现存表记录</p></li> <li><p>FILE 　　　　　　读或写服务器上的文件</p></li> <li><p>PROCESS 　　 查看服务器中执行的线程信息或杀死线程</p></li> <li><p>RELOAD 　　　　重载授权表或清空日志、主机缓存或表缓存。</p></li> <li><p>SHUTDOWN　　 关闭服务器</p></li> <li><p>ALL 　　　　　　所有；ALL PRIVILEGES同义词</p></li> <li><p>USAGE 　　　　特殊的“无权限”权限</p></li></ol> <h2 id="备份与恢复数据"><a href="#备份与恢复数据" class="header-anchor">#</a> 备份与恢复数据</h2> <ul><li>select * into outfile 'file_name' export_options | into dumpfile 'file_name  紧挨着</li> <li>load data infile 'file_name' into table tbl_name load_option</li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token keyword">fields</span>
  <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'string'</span> <span class="token comment">----字段间的符号</span>
  <span class="token keyword">optionally</span> <span class="token keyword">enclosed</span> <span class="token keyword">by</span> <span class="token string">'char'</span><span class="token comment">----optionally表示所有的值都放在双引号之间；字符值放在双引号之间</span>
  <span class="token keyword">escaped</span> <span class="token keyword">by</span> <span class="token string">'char'</span><span class="token comment">------转义字符</span>
<span class="token keyword">lines</span> <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'string'</span><span class="token comment">------备份时行结束标志</span>
<span class="token keyword">lines</span> <span class="token keyword">starting</span> <span class="token keyword">by</span> <span class="token string">'string'</span><span class="token comment">--------行前缀与后缀</span>
      <span class="token keyword">terminated</span> <span class="token keyword">by</span> <span class="token string">'string'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="常用操作"><a href="#常用操作" class="header-anchor">#</a> 常用操作</h2> <ol><li>操作之前判断 if not exists, 如 create table if not exists user</li> <li>更改编码类型：CHARACTER SET  指定字符集</li></ol> <h2 id="查看当前所在"><a href="#查看当前所在" class="header-anchor">#</a> 查看当前所在</h2> <ol><li>数据库</li> <li>帐户</li></ol> <h2 id="数据库"><a href="#数据库" class="header-anchor">#</a> 数据库</h2> <ol><li>启动：bash mysql.server start</li> <li>用户登录【交互模式】：Mysql -u root -p passwd；【命令模式】：mysql -p pwd -e &quot;查询命令或其他命令&quot;；【批处理模式】：more xxx.sql 或 source xxx.sql 或 mysql -u xxx -p xxx +&lt; xxx.sql</li> <li>连接远程数据库服务器：mysql  - D 所选择数据库名  -h 主机名 -u 用户名 -p 密码</li> <li>查看：show databases</li> <li>创建建：create database name</li> <li>启用：use databaseName 或 \u databaseName</li> <li>删除：Drop database databaseName</li> <li>备份：mysqldump -u root -p 数据库名&gt;url/xxx.sql</li> <li>恢复：mysql -u root 新数据库名+&lt;xxx.sql</li> <li>执行外部sql：mysql -u root -p --source xxx.sql 或 source xxx.sql</li></ol> <h2 id="表"><a href="#表" class="header-anchor">#</a> 表</h2> <ul><li>基础操作</li></ul> <ol><li>查看：Show tables;</li> <li>创建：Create table Tname (fieldName type description , fieldName…)</li> <li>插入：Insert into tableName ([fieldName, …]) values (v1,…)</li> <li>删除：Drop table Tname 或 Delete from Tname 。。。</li> <li>修改：Alter table tableName rename newTableName</li> <li>通过脚本文件创建表：mysql -D databaseName -u userName -p +&lt; createtable.sql</li> <li>创建时字段描述：类型[(长度)] 索引 自增 默认值(int unsigned primary key auto_increment unique not null default '')</li></ol> <h2 id="修改表结构："><a href="#修改表结构：" class="header-anchor">#</a> 修改表结构：</h2> <ol><li>add 字段 类型；删除 drop column 字段；更名或其他描述：change old字段名 new字段名 iteger；add index 索引名 (字段名, ...)</li> <li>修改字段描述：alter table table_name modify column field type;</li> <li>alter table note drop primary key; alter table note modify cloumn note_id auto_increment; alter table note add primary key(note_id);</li> <li>1 SELECT auto_increment FROM information_schema.tables where table_schema=&quot;dbName&quot; and table_name=&quot;tableName&quot;;</li> <li>alter 中使用 modify 与 change：alter table user change old_field new field integer</li> <li>add：alter table user add new_field 描述; add primary key(field);</li></ol> <ul><li>修改表结构</li></ul> <ol><li>添加字段：alter table tableName add fieldName  type after fieldName</li> <li>修改字段名：alter table tableName change newFieldName NewType</li> <li>删除字段：Alter table tableName drop fieldName</li> <li>创建表时与另一表有相同字段：foreign key (fieldName) references 表名 (fieldName);</li></ol> <h2 id="字段"><a href="#字段" class="header-anchor">#</a> 字段</h2> <ol><li>查询 desc 表名</li></ol> <h2 id="表数据"><a href="#表数据" class="header-anchor">#</a> 表数据</h2> <ol><li>插入：insert into tableName (fieldName,...) (values...)</li> <li>更新；update tableName set fieldName = v, ... where condition</li> <li>删除：delete from 表名 where condition</li></ol> <p>常用常量：
NULL default</p> <p>查询：
Select fieldName, …   from tableName where 运算</p> <p>更新：
update tableName set  fieldName = v  where 运算</p> <p>删除：
delete from tableName where 运算</p> <h2 id="主键，外键，关联"><a href="#主键，外键，关联" class="header-anchor">#</a> 主键，外键，关联</h2> <ol><li>主键：标识一条记录，不可重复或空；保证数据完整性。</li> <li>外键：另一个表的主键，可以空或重复，建立与其他表的联系。主键值修改，关联的数据也同步更新；保证了一致性。</li> <li>alter table 表名 add promary key 字段名/ constraint <code>外键名</code> foreign key 字段名 references 另一个表 (字段) / index (字段名)</li> <li>对外键关联操作的定义：on delete cascade on update cascade; 或 on delete no action on update no action;</li> <li>删除外键：alter table tableName drop foreign key <code>外键名</code></li> <li>取消外键：set foreign_key_checks = 0;</li></ol> <h2 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h2> <ul><li>数字类型
<ol><li>整数: tinyint、smallint、mediumint、int、bigint</li> <li>浮点数: float、double、real、decimal</li></ol></li> <li>日期和时间: date、time、datetime、timestamp、year</li> <li>字符串类型
<ol><li>字符串: char、varchar</li> <li>文本: tinytext、text、mediumtext、longtext</li></ol></li> <li>二进制(可用来存储图片、音乐等): tinyblob、blob、mediumblob、longblob</li> <li>对类型的描述：unsigned, signed</li> <li>Set, Enum类型</li> <li>修改字段类型：set foreign_key_checks = 0; alter table user modify column user_id bigint;set foreign_key_checks = 1;</li></ul> <h2 id="变量"><a href="#变量" class="header-anchor">#</a> 变量</h2> <ul><li><p>用户变量(会话变量)，声明：SET @标识符 = v；</p> <ol><li>在查询中使用：select @标识符</li> <li>在查询语句中进行赋值：select @标识符 := max(age) from student</li> <li>selct @@标识符</li></ol></li> <li><p>查看所有系统变量</p> <ul><li>show variables;</li></ul></li> <li><p>修改变量： set variable_name = new_name  , global关键字为永久修改</p></li></ul> <h2 id="帐户，是多用户数据库，访问mysql-user"><a href="#帐户，是多用户数据库，访问mysql-user" class="header-anchor">#</a> 帐户，是多用户数据库，访问mysql.user</h2> <ol><li>数据库mysql</li> <li>相关数据表：user, db, host, tables_priv, columns_priv, procs_priv...</li> <li>user存储包含：用户信息(主机%、用户名、密码)，权限_priv，安全ssl_，资源分配max_</li> <li>可以select, insert, alter相关的权限表：table_priv, column_priv, procs_priv</li> <li>查询：select user from mysql.user</li> <li>创建：create user user_name[@hostname] [identified by 'password']</li> <li>删除：drop user 'username'@'hostname'</li> <li>更新密码：set password for 'username' = password('password') 或 = ‘password’ 或 update user set password = password('password') where user=&quot;username&quot;</li> <li>delete from mysql.user where user=&quot;username&quot;</li> <li>更新密码：update mysql.user set password=password('1111') where user = 'root';
或 修改当前用户密码 set password=password('1111');
或set password for '用户名'@'主机名' = password=password('1111')</li></ol> <ul><li><p>权限</p> <ol><li>权限分为：ALL PRIVILEGES、CREATE、ALTER、INSERT、UPDATE、DELETE、SELECT</li> <li>创建用户并设置权限：grant 权限值, (select,insert,update,delete) on 数据库名.表 to 'username'@'hostname' [identified by 'password']</li> <li>对账户进行权限增加：grant 权限值, ... on 数据库名. to username1, username2... with grant option</li> <li>刷新权限：flush privileges</li> <li>回收权限：revoke privilege 权限值, ... on 数据库名.表 from 'username'@'hostname'</li> <li>权限有：select ,update,delete,insert(表数据)、create,alert,drop(表结构)、references(外键)、create temporary tables(创建临时表)、index(操作索引)、create view,show view(视图)、create routine,alert routine,execute(存储过程)、all,all privileges(所有权限)</li> <li>查看权限：show grants 或 show grants for username@主机名称</li></ol></li> <li><p>如何使用：</p> <ol><li>information_schema&gt;[table]: user_privileges</li> <li>mysql&gt;[table]: tables_priv / columns_priv</li> <li>select * from mysql.columns_priv where user='' and host=''</li></ol></li></ul> <div class="language-sql line-numbers-mode"><pre class="language-sql"><code><span class="token comment"># % 表示任意主机，.表示数据库中所有都授权</span>
<span class="token keyword">GRANT</span> <span class="token keyword">ALL</span> <span class="token keyword">PRIVILEGES</span> <span class="token keyword">ON</span> test<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> <span class="token string">'semon'</span><span class="token variable">@'%'</span> IDENTIFIED <span class="token keyword">BY</span> <span class="token string">'semon'</span><span class="token punctuation">;</span>
<span class="token keyword">GRANT</span> <span class="token keyword">CREATE</span> <span class="token keyword">ON</span> test<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">TO</span> demon <span class="token keyword">WITH</span> <span class="token keyword">GRANT</span> <span class="token keyword">OPTION</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="性能"><a href="#性能" class="header-anchor">#</a> 性能</h2> <ol><li>开启时间监测：set profiling = 1;</li> <li>查看检测结果：show profiles;</li></ol> <h2 id="索引：提高了查询速度，但降低更新表的速度，因更新时需要保存数据，同时保存索引文件，会占磁盘空间"><a href="#索引：提高了查询速度，但降低更新表的速度，因更新时需要保存数据，同时保存索引文件，会占磁盘空间" class="header-anchor">#</a> 索引：提高了查询速度，但降低更新表的速度，因更新时需要保存数据，同时保存索引文件，会占磁盘空间</h2> <ol><li>创建：create index 索引名称 on 表名(字段名(长度))</li> <li>查看：show index from 表名</li> <li>删除：drop index 索引名 on 表名</li> <li>普通、唯一、全文索引；主键、外键</li></ol> <h2 id="关联-外键关系"><a href="#关联-外键关系" class="header-anchor">#</a> 关联(外键关系)</h2> <ol><li>foreign key(user_id) references user(user_id)</li></ol> <h2 id="函数-存储过程"><a href="#函数-存储过程" class="header-anchor">#</a> 函数/存储过程</h2> <ul><li><p>创建函数，创建后会存到表中</p> <ol><li>create function <code>function_name</code>(param type, ...) returns return_type  下面是 begin 函数体语句; return v; end</li> <li>临时变量声明：delare 变量名 变量类型 [default v]</li> <li>临时变量赋值：set 变量名 = 表达式, ...</li> <li>delimiter 标识符</li> <li>使用：select field from databaseName where name = 'function_name';  select function_name();</li> <li>删除函数：delete from database where name='function_name'</li> <li>循环：while 条件 do 循环体; end while;</li> <li>条件：if 条件 then 语句; end if; (判断相等是 = )</li> <li>调用：select fun(params)</li> <li>drop function if exists fun 可加条件的删除</li> <li>已提供的通用方法：</li></ol></li> <li><p>delimiter 在命令行中，默认;回车即为结束，这时需要把结束符定义成其他符号，如$$ 或 //; 例子：1) delimiter // 2) 函数或过程体    3)  end; //</p></li> <li><p>存储过程：是存储在数据库中的一组SQL语句，可以在查询过程中调用这个<code>过程名字</code>来执行相关SQL</p> <ol><li>delimiter // create procedure procedure_name(params) 下面是 begin 过程体语句; end // delimiter;</li> <li>参数类型：in 传入类型的参数， out 传出类型的参数(相当于return)，inout 既能传入又能传出</li> <li>调用：call procedure_name; 或 call procedure_name(params);</li> <li>删除：drop procedure procedureName</li></ol></li></ul> <h2 id="视图：对select语句进行封装，即存储在数据库中的一个虚拟表；-复杂的查询，多处使用，想更改很麻烦"><a href="#视图：对select语句进行封装，即存储在数据库中的一个虚拟表；-复杂的查询，多处使用，想更改很麻烦" class="header-anchor">#</a> 视图：对select语句进行封装，即存储在数据库中的一个虚拟表；(复杂的查询，多处使用，想更改很麻烦)</h2> <ol><li>创建：create view view_name as select XX as 'XX', ... from tableName as 's'</li> <li>查看：show tables</li> <li>调用：select field from view_name;</li> <li>删除：drop view view_name</li></ol> <h2 id="事务：解决操作集合，如转帐，包含扣钱方-和-收钱方，整个操作是一体的，一个单元失败则会回滚"><a href="#事务：解决操作集合，如转帐，包含扣钱方-和-收钱方，整个操作是一体的，一个单元失败则会回滚" class="header-anchor">#</a> 事务：解决操作集合，如转帐，包含扣钱方 和 收钱方，整个操作是一体的，一个单元失败则会回滚</h2> <ul><li>原子性：全部操作，要做全做，要不做全不做</li> <li>一致性：结果一致</li> <li>隔离性：一个事务不爱另一个事务的影响</li> <li>持久性：对已提交的事务，系统必须保证该事务对数据库的改变不被丢失</li> <li>事务提交：整个事务下的操作集全部有效</li> <li>事务回滚：整个事务下的操作集全部作废</li> <li>脏读：一个事务将数据改变，但还未提交；此时另一个事务读取时读到的是新数据，而事务又将其回滚，此时事务再读取，发现数据又变回去了；而此前读到的变成的脏数据。(解决问题的方式：读已提交，可重复读)</li> <li>不可复读：事务多次查询数据，因另一事务对数据的操作，导致查询数据结果不一致。(解决问题的方式：可重复读)</li> <li>虚/幻读：事务读取值后对其更名，而另一事务又创建了此名称，而原事务再查询时发现未修改，产生了幻觉。(读未提交，读已提交)</li> <li>读已提交：一个事务在写时，禁止其他事务读写，提交后才能被读取。</li> <li>可重复读：一个事务在写时，禁止其他事务读写，一个事务在读取时，禁止其他事务写。</li> <li>串行化：每次只能执行一个事务。</li> <li>mySQL：采用innodb为其默认引擎。insert, update, delete会触发事务；开启事务后，变更会维护到本地缓存中，而非物理表中。</li> <li>使用：begin; 提交事务 comit; 回滚事务 rollback;</li> <li>关闭默认事务提交：set [global] autocommit = 0;</li></ul> <h2 id="其他命令"><a href="#其他命令" class="header-anchor">#</a> 其他命令</h2> <ol><li>status, help  === ? 也可以 help select</li> <li>退出当前数据库：\q</li> <li>用户select user()\g 或 select User, Host, Password from user</li> <li>取消执行的命令：select \c</li> <li>select current_time();</li> <li>select 算术运算</li> <li>delimiter $$  ... end $$ delimiter ;  先定义结束符，再恢复。</li></ol> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <ul><li>字符串</li></ul> <ol><li>select concat('a','-','b') 字符串连接</li> <li>concat_ws('||','a','-','b') 以||字符间隔连接</li> <li>lower() / lcase(), upper()</li> <li>left(), right() 获取左 或 右侧字符串</li> <li>ltrim(), rtrim() 删除前导 或 后续空格</li> <li>replace(str, '?', '-') 将?替换成-</li> <li>substring(str, offset, length)</li> <li>trim() 删除前后两边的空格，也可以删除指定前导 和 后续的字符串
trim(leading'?', '??abc????') 删除前导?号
trim(trailing'?', '??abc????') 删除后续?号
trim(both'?', '??abc????') 删除两边?号</li> <li>[not] like (% 代表0 或 多个任意字符，_任意一个字符)</li> <li>escape</li> <li>length()</li> <li>instr(str, substr) 子串第一个出现的位置</li></ol> <ul><li>数字</li></ul> <ol><li>format(124567.7, 2) 保留两位小数，第三位一个逗号</li> <li>ceil() 入，取整</li> <li>floor() 舍，取整</li> <li>div 整数除法，如：3 div 4 = 0；/是有小数的</li> <li>mod 取余 与 % 一样</li> <li>power(3, 4) 幂</li> <li>round(3.1415, 4) 取余，四舍五入；总长度为4</li> <li>truncate(3.1415, 2) 截断，不四舍五入；保留2位小数</li> <li>rand()</li> <li>least(v1, v2, ...); greatest(v1, v2, ...)</li> <li>abs()</li></ol> <ul><li>日期时间</li></ul> <ol><li>now() 当前日期和时间</li> <li>curdate() 当前日期</li> <li>curtime() 当前时间</li> <li>date_add('2016-6-6', interval 1 year) 日期和一段时间的和 或 week, month</li> <li>datediff('2016-6-6','2015-6-6') 日期的差</li> <li>date_format('2016-6-6', '%m/%d/%Y') 日期格式化</li> <li>sysdate() 与 current_timestamp() 与 now()一样</li> <li>dayname(date) 获取星期几</li> <li>str_to_date('2017年1月10号 11时02分02秒', '%Y年%m月%d号 %h时%i分%s秒') %H为24小时制</li></ol> <ul><li>比较</li></ul> <ol><li>field is [not] null</li> <li>value [not] / in(1,2,3,5,6)</li> <li>value [not]between A and B;</li> <li>= 与 +&lt;=&gt; 判断等于null时结果不同</li> <li>isnull(field)</li></ol> <ul><li>数据库信息函数</li></ul> <ol><li>select connection_id()</li> <li>select database()</li> <li>select last_insert_id()</li> <li>version()</li> <li>user()</li></ol> <ul><li>聚合函数</li></ul> <ol><li>round(avg(field), 3) as avg_field</li> <li>count(field) as counts</li> <li>max(field) as max_field; min</li> <li>sum(field) as sum_field</li></ol> <ul><li>语句</li></ul> <ol><li>(case field when v then expr when v2 then expr2 else expr3 end) as field1</li> <li>if(expr, expr2, expr3) if函数</li></ol> <ul><li>加密函数</li></ul> <ol><li>md5('')</li> <li>password('')</li></ol> <ul><li>并发控制(多个连接对记录进行修改时，保证数据的一致性与完整性，且锁系统来控制)</li></ul> <ol><li>共享锁(读锁)：同一时间内，多用户可以读取同一个资源，读取过程中不会发生任何变化。</li> <li>排他锁(写锁)：任何时间只能有一个用户写入资源，进行写锁时会阻塞其他读或写锁操作。</li> <li>锁的力度娘----表锁(开销最小)，行锁(开销最大，并行性最大)，开销与使用锁的个数有关。</li> <li>存储引擎：default-storage-engine = innoDB 或 create table table_name() engine = innoDB; 或 alter table tbl_name engine = innoDB;</li></ol> <h2 id="题"><a href="#题" class="header-anchor">#</a> 题</h2> <ul><li>编写一个 SQL 查询，获取 Employee 表中第二高的薪水（Salary），返回字段名为SecondHighestSalary，为空时返回null (176) {&quot;headers&quot;: {&quot;Employee&quot;: [&quot;Id&quot;, &quot;Salary&quot;]}, &quot;rows&quot;: {&quot;Employee&quot;: [[1, 100]]}}
<ul><li>select (select distinct (Salary) from Employee order by Salary Desc limit 1,1) as SecondHighestSalary</li></ul></li> <li>某网站包含两个表，Customers 表和 Orders 表。编写一个 SQL 查询，找出所有从不订购任何东西的客户。(183);
<ul><li>select Name as Customers from Customers  where Id not in (select CustomerId  from Orders)</li> <li>select Name from Customers c left join Orders o on c.Id = o.CustomerId where o.Id is NULL</li></ul></li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.53e266ef.js" defer></script><script src="/assets/js/97.e7f632c9.js" defer></script>
  </body>
</html>
